import gasTimer from"./gas.min.js";import chart from"./chart.min.js";import api from"./api.min.js";import{login,menu,Dropdown,network,advisor,messageBus}from"./utils.min.js";document.addEventListener("DOMContentLoaded",async()=>{menu.init(),gasTimer.init(),chart.init(),advisorDOM.init();const networkSwitcher={element:document.querySelector("#network-btn"),bound:!1,reload:function(){this.bound||(this.bound=!0,this.bindClick(),this.element.classList.remove("hidden")),document.querySelector("#header #link").href=`https://owlracle.info/${network.get().symbol}`,this.element.removeAttribute("class"),this.element.classList.add(network.get().symbol),this.element.querySelector("img").src=`https://owlracle.info/img/${network.get().symbol}.png`,this.element.querySelector("span").innerHTML=network.get().name,"gas"==menu.getActive()&&gasTimer.update(),"chart"==menu.getActive()&&chart.timeframeSwitch()},get:function(){return this.element},bindClick:function(){new Dropdown({button:this.element,itemList:Object.values(network.getList()).map(e=>({id:e.symbol,innerHTML:`<img class="icon" src="${e.icon.src}" alt="${e.name} icon"><span class="name">${e.name}</span>`})),clickFn:e=>{network.set(e.id),this.reload()}})}};menu.setClick("gas",()=>networkSwitcher.reload()),menu.setClick("chart",()=>networkSwitcher.reload()),menu.setClick("key",()=>api.check()),login.get("apikey")&&login.refresh();let menuOpt=null;login.get("logged")||(menuOpt="key"),menu.click(menuOpt),messageBus.watch(),messageBus.addEvent("network",message=>{if(!message.message.network)return document.querySelector("#content #advisor #network-container #network").innerHTML='<b class="red">Unsupported network</b>',advisorDOM.network=!1,!1;const ntw=network.get(message.message.network);return document.querySelector("#content #advisor #network-container #network").innerHTML=`<img src="https://owlracle.info/img/${ntw.symbol}.png"><span>${ntw.name}</span>`,advisorDOM.network=ntw,!0})});const advisorDOM={init:async function(){const adv=await advisor.get(),container=document.querySelector("#content #advisor");container.innerHTML=`<div id="content" class="logged">\n            <h2>Tx advisor</h2>\n            <div id="metamask-connected">\n                <img src="img/metamask-fox.svg" id="metamask-icon">\n                <div id="network-container">\n                    <span>Metamask connected to</span>\n                    <div id="network"></div>\n                </div>\n            </div>\n            <div id="enable-container">\n                <label><input id="allow" type="checkbox" class="checkbox" ${adv.enabled?"checked":""}>Allow me to suggest the best gas price to your Metamask transaction</label>\n                <div id="cost-card">\n                    <span class="title">ðŸ¦Š advice cost</span>\n                    <div class="card">Not receiving advices</div>\n                </div>\n            </div>\n        </div>`,container.querySelector("#allow").addEventListener("change",(function(){advisor.set({enabled:this.checked})})),messageBus.send("get-network",{},message=>{if(!message)return container.querySelector("#network-container #network").innerHTML='<b class="red">Unsupported network</b>',this.network=!1,!1;const ntw=network.get(message);return container.querySelector("#network-container #network").innerHTML=`<img src="https://owlracle.info/img/${ntw.symbol}.png"><span>${ntw.name}</span>`,this.network=ntw,!0})}};
//# sourceMappingURL=popup.min.js.map