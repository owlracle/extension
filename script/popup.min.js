import gasTimer from"./gas.min.js";import chart from"./chart.min.js";import api from"./api.min.js";import advisor from"./advisor.min.js";import{login,menu,Dropdown,network,messageBus}from"./utils.min.js";document.addEventListener("DOMContentLoaded",async()=>{menu.init(),gasTimer.init(),chart.init(),advisor.init();const networkSwitcher={element:document.querySelector("#network-btn"),bound:!1,reload:async function(){this.bound||(this.bound=!0,this.bindClick(),this.element.classList.remove("hidden"));const ntw=await network.get();document.querySelector("#header #link").href=`https://owlracle.info/${ntw.symbol}`,this.element.removeAttribute("class"),this.element.classList.add(ntw.symbol),this.element.querySelector("img").src=`https://owlracle.info/img/${ntw.symbol}.png`,this.element.querySelector("span").innerHTML=ntw.name,"gas"==menu.getActive()&&gasTimer.update(),"chart"==menu.getActive()&&chart.timeframeSwitch()},get:function(){return this.element},bindClick:function(){new Dropdown({button:this.element,itemList:Object.values(network.getList()).map(e=>({id:e.symbol,innerHTML:`<img class="icon" src="${e.icon.src}" alt="${e.name} icon"><span class="name">${e.name}</span>`})),clickFn:e=>{network.set(e.id),this.reload()}})}};menu.setClick("gas",()=>networkSwitcher.reload()),menu.setClick("chart",()=>networkSwitcher.reload()),menu.setClick("advisor",()=>advisor.init()),menu.setClick("key",()=>api.check()),await login.get("apikey")?login.refresh():menu.disable("advisor");let menuOpt=null;await login.get("logged")||(menuOpt="key"),menu.click(menuOpt),messageBus.watch(),messageBus.addEvent("network",async message=>{if(!message.message.network)return document.querySelector("#content #advisor #network-container #network").innerHTML='<b class="red">Unsupported network</b>',advisor.network=!1,advisor.setCost(),!1;const ntw=await network.get(message.message.network);return document.querySelector("#content #advisor #network-container #network").innerHTML=`<img src="https://owlracle.info/img/${ntw.symbol}.png"><span>${ntw.name}</span>`,advisor.network=ntw,advisor.setCost(),!0})});
//# sourceMappingURL=popup.min.js.map