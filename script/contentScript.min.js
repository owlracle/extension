const script=document.createElement("script");script.src=chrome.runtime.getURL("script/inject.min.js"),script.type="module",(document.head||document.documentElement).appendChild(script),script.onload=()=>script.remove();const messageDOM={events:{},watchDomMessage:async function(id){return new Promise(resolve=>{const checkInt=setInterval(()=>{const extMessageContainer=document.querySelector("#"+id);if(extMessageContainer){const extMessage=JSON.parse(extMessageContainer.value);extMessageContainer.remove(),clearInterval(checkInt),resolve(extMessage)}},100)})},writeDomMessage:function(id,message){const el=document.createElement("input");el.id=id,el.type="hidden",el.value=JSON.stringify(message),document.body.insertAdjacentElement("beforeend",el)},send:async function(message){return this.writeDomMessage("extension-message-received",message),await this.watchDomMessage("extension-message-received-reply")},addEvent:function(name,callback){this.events[name]=callback},watch:async function(){const message=await this.watchDomMessage("extension-message-sent");Object.keys(this.events).includes(message.event)?this.events[message.event](message.message):chrome.runtime.sendMessage(message,response=>{this.writeDomMessage("extension-message-sent-reply",response)}),setTimeout(()=>this.watch(),100)}};messageDOM.watch(),chrome.runtime.onMessage.addListener((message,sender,reply)=>("advisor"==message.event?advisor.updateDOM().then(()=>reply("ok")):messageDOM.send(message).then(response=>reply(response)),!0));const advisor={init:async function(){const storage=await chrome.storage.local.get();return storage.advisor&&"object"==typeof storage?storage.advisor:(await chrome.storage.local.set({advisor:{enabled:!1}}),{enabled:!1})},get:async function(){const storage=await chrome.storage.local.get();return storage.advisor||await new Promise(resolve=>setTimeout(async()=>resolve(await this.get()),100))},updateDOM:async function(init=!1){const advProp=await(init?this.init():this.get()),message={event:"advisor"};advProp.enabled?(advProp.apiKey&&(message.apiKey=advProp.apiKey),advProp.speed&&(message.speed=advProp.speed),advProp.notifications&&(message.notifications=advProp.notifications)):init||(message.apiKey=!1),messageDOM.send(message)}};advisor.updateDOM(!0);
//# sourceMappingURL=contentScript.min.js.map